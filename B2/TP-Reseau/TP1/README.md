# TP1 : MaÃ®trise rÃ©seau du poste

- [TP1 : MaÃ®trise rÃ©seau du poste](#tp1--maÃ®trise-rÃ©seau-du-poste)
- [I. Basics](#i-basics)
- [II. Go further](#ii-go-further)
- [III. Le requin](#iii-le-requin)

# I. Basics

â˜€ï¸ **Carte rÃ©seau WiFi**


- l'adresse MAC de votre carte WiFi

```bash
[ahliko@ahliko-PC ~]$ ip a show wlp4s0 | awk '/ether/ {print $2}'                                      î‚² âœ” 
e0:0a:f6:6d:2d:fd
```

- l'adresse IP de votre carte WiFi

```bash
[ahliko@ahliko-PC ~]$ ip a show wlp4s0 | awk '/inet/ {print $2}' | head -n 1                           î‚² âœ” 
10.33.64.136/20
```
- le masque de sous-rÃ©seau du rÃ©seau LAN auquel vous Ãªtes connectÃ©s en WiFi
    - en notation CIDR, par exemple `/16`
```bash
[ahliko@ahliko-PC ~]$ ip a show wlp4s0 | awk '/inet/ {print $2}' | head -n 1                           î‚² âœ” 
10.33.64.136/20
```

    - ET en notation dÃ©cimale, par exemple `255.255.0.0`
```bash
[ahliko@ahliko-PC ~]$ sipcalc 10.33.64.136/20 | grep 'Network mask' | head -n 1                        î‚² âœ” 
Network mask		- 255.255.240.0
```

---

â˜€ï¸ **DÃ©so pas dÃ©so**

Pas besoin d'un terminal lÃ , juste une feuille, ou votre tÃªte, ou un tool qui calcule tout hihi. DÃ©terminer...

- l'adresse de rÃ©seau du LAN auquel vous Ãªtes connectÃ©s en WiFi
```bash
[ahliko@ahliko-PC ~]$ sipcalc 10.33.64.136/20 | grep 'Network range' | awk '/-/ {print $4}'            î‚² âœ” 
10.33.64.0
```

- l'adresse de broadcast
```bash
[ahliko@ahliko-PC ~]$ sipcalc 10.33.64.136/20 | grep 'Broadcast'                                       î‚² âœ” 
Broadcast address	- 10.33.79.255
```

- le nombre d'adresses IP disponibles dans ce rÃ©seau
```bash
[ahliko@ahliko-PC ~]$ sipcalc 10.33.64.136/20 | grep 'Addresses in network'                            î‚² âœ” 
Addresses in network	- 4096
```

---

â˜€ï¸ **Hostname**

- dÃ©terminer le hostname de votre PC
```bash
[ahliko@ahliko-PC ~]$ hostname                                                                         î‚² âœ” 
ahliko-PC
```

---

â˜€ï¸ **Passerelle du rÃ©seau**

DÃ©terminer...

- l'adresse IP de la passerelle du rÃ©seau
```bash
[ahliko@ahliko-PC ~]$ ip n s | awk '// {print $1}'
10.33.79.254
```
- l'adresse MAC de la passerelle du rÃ©seau
```bash
[ahliko@ahliko-PC ~]$ ip n s | awk '// {print $5}'
7c:5a:1c:d3:d8:76 
```

---

â˜€ï¸ **Serveur DHCP et DNS**

- l'adresse IP du serveur DHCP qui vous a filÃ© une IP
```bash
[ahliko@ahliko-PC ~]$ ip n s | awk '// {print $1}'
10.33.79.254
```
- l'adresse IP du serveur DNS que vous utilisez quand vous allez sur internet
```bash
[ahliko@ahliko-PC ~]$ cat /etc/resolv.conf 
# Generated by NetworkManager
nameserver 8.8.8.8
nameserver 1.1.1.1
```

---

â˜€ï¸ **Table de routage**

- dans votre table de routage, laquelle est la route par dÃ©faut
```bash
[ahliko@ahliko-PC ~]$ ip route show | grep default
default via 10.33.79.254 dev wlp4s0 proto dhcp src 10.33.64.136 metric 600 
```

---

# II. Go further

---

â˜€ï¸ **Hosts ?**

- faites en sorte que pour votre PC, le nom `b2.hello.vous` corresponde Ã  l'IP `1.1.1.1`
```bash
[ahliko@ahliko-PC ~]$ cat /etc/hosts
# Standard host addresses
127.0.0.1  localhost
::1        localhost ip6-localhost ip6-loopback
ff02::1    ip6-allnodes
ff02::2    ip6-allrouters
# This host address
127.0.1.1  ahliko-PC
1.1.1.1 b2.hello.vous
```
- prouvez avec un `ping b2.hello.vous` que Ã§a ping bien `1.1.1.1`

```bash
[ahliko@ahliko-PC ~]$ ping b2.hello.vous
PING b2.hello.vous (1.1.1.1) 56(84) octets de donnÃ©es.
64Â octets de b2.hello.vous (1.1.1.1)Â : icmp_seq=1 ttl=57 temps=15.8Â ms
64Â octets de b2.hello.vous (1.1.1.1)Â : icmp_seq=2 ttl=57 temps=11.6Â ms
^C
--- statistiques ping b2.hello.vous ---
2Â paquets transmis, 2 reÃ§us, 0% packet loss, time 1001ms
rtt min/avg/max/mdev = 11.615/13.722/15.829/2.107 ms
```

---

â˜€ï¸ **Go mater une vidÃ©o youtube et dÃ©terminer, pendant qu'elle tourne...**



![Sans titre.png](..%2F..%2F..%2F..%2F..%2FImages%2FSans%20titre.png)
- l'adresse IP du serveur auquel vous Ãªtes connectÃ©s pour regarder la vidÃ©o ===> 1
- le port du serveur auquel vous Ãªtes connectÃ©s ===> 3
- le port que votre PC a ouvert en local pour se connecter au port du serveur distant ====> 2

---

â˜€ï¸ **RequÃªtes DNS**



- Ã  quelle adresse IP correspond le nom de domaine `www.ynov.com`

```bash
[ahliko@ahliko-PC ~]$ drill www.ynov.com
;; ->>HEADER<<- opcode: QUERY, rcode: NOERROR, id: 39956
;; flags: qr rd ra ; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 0 
;; QUESTION SECTION:
;; www.ynov.com.	IN	A

;; ANSWER SECTION:
www.ynov.com.	154	IN	A	172.67.74.226
www.ynov.com.	154	IN	A	104.26.11.233
www.ynov.com.	154	IN	A	104.26.10.233

;; AUTHORITY SECTION:

;; ADDITIONAL SECTION:

;; Query time: 19 msec
;; SERVER: 1.1.1.1
;; WHEN: Thu Oct 12 12:15:31 2023
;; MSG SIZE  rcvd: 78
```

- Ã  quel nom de domaine correspond l'IP `174.43.238.89`

```bash
[ahliko@ahliko-PC ~]$ drill -x 174.43.238.89
;; ->>HEADER<<- opcode: QUERY, rcode: NOERROR, id: 64183
;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0 
;; QUESTION SECTION:
;; 89.238.43.174.in-addr.arpa.	IN	PTR

;; ANSWER SECTION:
89.238.43.174.in-addr.arpa.	7200	IN	PTR	89.sub-174-43-238.myvzw.com.
```

---

â˜€ï¸ **Hop hop hop**


- par combien de machines vos paquets passent quand vous essayez de joindre `www.ynov.com`
```bash
[ahliko@ahliko-PC ~]$ traceroute www.ynov.com
traceroute to www.ynov.com (104.26.10.233), 30 hops max, 60 byte packets
 1  _gateway (10.33.79.254)  4.301 ms  4.238 ms  4.076 ms
 2  145.117.7.195.rev.sfr.net (195.7.117.145)  2.358 ms  2.335 ms  2.318 ms
 3  * * *
 4  196.224.65.86.rev.sfr.net (86.65.224.196)  2.233 ms  2.215 ms  2.198 ms
 5  68.150.6.194.rev.sfr.net (194.6.150.68)  12.550 ms  12.534 ms 12.148.6.194.rev.sfr.net (194.6.148.12)  12.511 ms
 6  68.150.6.194.rev.sfr.net (194.6.150.68)  12.492 ms 12.148.6.194.rev.sfr.net (194.6.148.12)  10.335 ms  10.324 ms
 7  141.101.67.48 (141.101.67.48)  10.317 ms  24.767 ms  24.747 ms
 8  141.101.67.54 (141.101.67.54)  16.919 ms 172.71.132.4 (172.71.132.4)  19.646 ms 141.101.67.54 (141.101.67.54)  10.615 ms
 9  104.26.10.233 (104.26.10.233)  10.562 ms  43.940 ms  43.867 ms
```

---

â˜€ï¸ **IP publique**

- l'adresse IP publique de la passerelle du rÃ©seau (le routeur d'YNOV donc si vous Ãªtes dans les locaux d'YNOV quand vous faites le TP)
```bash
[ahliko@ahliko-PC ~]$ curl ifconfig.me
195.7.117.146
```

---

â˜€ï¸ **Scan rÃ©seau**

- combien il y a de machines dans le LAN auquel vous Ãªtes connectÃ©s
  (nmap)
```bash

```

# III. Le requin

Faites chauffer Wireshark. Pour chaque point, je veux que vous me livrez une capture Wireshark, format `.pcap` donc.

Faites *clean* ğŸ§¹, vous Ãªtes des grands now :

- livrez moi des captures rÃ©seau avec uniquement ce que je demande et pas 40000 autres paquets autour
    - vous pouvez sÃ©lectionner seulement certains paquets quand vous enregistrez la capture dans Wireshark
- stockez les fichiers `.pcap` dans le dÃ©pÃ´t git et cÃ´tÃ© rendu Markdown, vous me faites un lien vers le fichier, c'est cette syntaxe :

```markdown
[Lien vers capture ARP](./captures/arp.pcap)
```

---

â˜€ï¸ **Capture ARP**

- ğŸ“ fichier `arp.pcap`
- capturez un Ã©change ARP entre votre PC et la passerelle du rÃ©seau

> Si vous utilisez un filtre Wireshark pour mieux voir ce trafic, prÃ©cisez-le moi dans le compte-rendu.

---

â˜€ï¸ **Capture DNS**

- ğŸ“ fichier `dns.pcap`
- capturez une requÃªte DNS vers le domaine de votre choix et la rÃ©ponse
- vous effectuerez la requÃªte DNS en ligne de commande

> Si vous utilisez un filtre Wireshark pour mieux voir ce trafic, prÃ©cisez-le moi dans le compte-rendu.

---

â˜€ï¸ **Capture TCP**

- ğŸ“ fichier `tcp.pcap`
- effectuez une connexion qui sollicite le protocole TCP
- je veux voir dans la capture :
    - un 3-way handshake
    - un peu de trafic
    - la fin de la connexion TCP

> Si vous utilisez un filtre Wireshark pour mieux voir ce trafic, prÃ©cisez-le moi dans le compte-rendu.

---

![Packet sniffer](img/wireshark.jpg)

> *Je sais que je vous l'ai dÃ©jÃ  servi l'an dernier lui, mais j'aime trop ce meme hihi ğŸˆ*